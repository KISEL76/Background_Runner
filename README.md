<h1 align="center">Queue Service
<p>Background Task Processing App</p>
</h1>

<p align="center">
  <img src="https://media2.giphy.com/media/v1.Y2lkPTc5MGI3NjExeHppdnN1dG81dDN1czN4Y2ozeThkdXM0YjRyYWVwbnNzamlqdmpnbCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/G3Hu8RMcnHZA2JK6x1/giphy.gif" alt="alt" width="300" />
</p>

## üõ†Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–π —Å—Ç–µ–∫

- **Golang 1.24** - –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å (–æ—á–µ—Ä–µ–¥—å, –≤–æ—Ä–∫–µ—Ä—ã, API)  
- **–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã Go** - –≤—Å–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –±–µ–∑ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫  
- **Docker + Makefile** - –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∏ –±—ã—Å—Ç—Ä—ã—Ö –∫–æ–º–∞–Ω–¥  

## ‚öôÔ∏è –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

- `WORKERS` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ—Ä–∫–µ—Ä–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 4)  
- `QUEUE_SIZE` ‚Äî —Ä–∞–∑–º–µ—Ä –æ—á–µ—Ä–µ–¥–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 64)  

## üöÄ –ó–∞–ø—É—Å–∫ –∏ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ API

1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Ñ–∞–π–ª `.env`

2. –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞:  
   ```bash
   make build
   ```

3. –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:  
   ```bash
   make run
   ```

4. –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ —Å–µ—Ä–≤–∏—Å –∂–∏–≤:  
   ```bash
   curl http://localhost:8080/health
   ```

5. –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–¥–∞—á–∏ –≤ –æ—á–µ—Ä–µ–¥—å:  
   ```bash
    curl -X POST http://localhost:8080/enqueue \
     -H "Content-Type: application/json" \
     -d '{"id":"t1","payload":"data","max_retries":3}'
   ```

6. –ê —Ç–∞–∫–∂–µ:
    ```bash
      make # —Å–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
      make test # –∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ (—é–Ω–∏—Ç –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ)
      make test_race # –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ data race
      make vet # –∞–Ω–∞–ª–∏–∑ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ 
    ```

## üìå –ü–æ–¥—Ö–æ–¥ –∫ —Ä–µ—à–µ–Ω–∏—é

1. **–†–∞–∑–±–æ—Ä –∑–∞–¥–∞–Ω–∏—è**  
   –ù—É–∂–Ω–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å: –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á -> –ø—É–ª –≤–æ—Ä–∫–µ—Ä–æ–≤ -> HTTP API c graceful shutdown

2. **–î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è**  
   –ö–æ–¥ —Ä–∞–∑–¥–µ–ª—ë–Ω –Ω–∞ —Ç–∞–∫–∏–µ **–∫–ª—é—á–µ–≤—ã–µ** –º–æ–¥—É–ª–∏:  
   - `queue` - –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á —Å –∫–∞–Ω–∞–ª–∞–º–∏ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º  
   - `store` - in-memory —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∑–∞–¥–∞—á –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å–æ–≤ (map + RWMutex)
   - `worker` - –ø—É–ª –≤–æ—Ä–∫–µ—Ä–æ–≤ —Å —Ä–µ—Ç—Ä–∞—è–º–∏ –∏ backoff-–∞–ª–≥–æ—Ä–∏—Ç–º–æ–º —Å –¥–∂–∏—Ç—Ç–µ—Ä–æ–º
   - `handlers` - HTTP API (`/health`, `/enqueue`)

   +–≤—Ç–æ—Ä–∏—á–Ω—ã–µ –º–æ–¥—É–ª–∏ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –∏ —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏. –í—Å–µ –æ–Ω–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `internal`

3. **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**  
   - –ó–∞–¥–∞—á–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ –≤–∏–¥–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–æ –≤—Å–µ–º–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –ø–æ–ª—è–º–∏ + –ø–æ–ª—è–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –º–∞—Ä—à–∞–ª—è—Ç—Å—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–≤–∞–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–¥–∞—á –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–ø—ã—Ç–æ–∫ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–∏.  
   - –û—á–µ—Ä–µ–¥—å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–¥–∞—á–∏ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞, –≤–æ—Ä–∫–µ—Ä—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –∑–∞–¥–∞—á–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –∏–∑ –∫–∞–Ω–∞–ª–∞ –æ—á–µ—Ä–µ–¥–∏.  
   - –û—à–∏–±–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º backoff + –¥–∂–∏—Ç—Ç–µ—Ä.  
   - –ü—Ä–∏ `Ctrl+C` –Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ –Ω–µ –±–µ—Ä—É—Ç—Å—è, –Ω–æ –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è.

4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**  
   –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Ä–æ–≤–Ω–µ–π —Ç–µ—Å—Ç–æ–≤:  
   - unit-—Ç–µ—Å—Ç—ã –¥–ª—è –æ—á–µ—Ä–µ–¥–∏, —Ö—Ä–∞–Ω–∏–ª–∏—â–∞, –≤–æ—Ä–∫–µ—Ä–æ–≤;  
   - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ `backoffWithJitter`;  
   - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å—é —Å–∏—Å—Ç–µ–º—É –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –≤—Å–µ –∑–∞–¥–∞—á–∏ –±–µ—Ä—É—Ç—Å—è –∏ –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è (`done` –∏–ª–∏ `failed`);  
   - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ data race —á–µ—Ä–µ–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç Golang

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ –∑–∞–¥–∞—á–∏ –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ (`map[string]*Task`).  
- –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è.  
# Jobpipe
